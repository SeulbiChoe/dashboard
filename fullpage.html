<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Fullpage + Footer Scroll</title>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      overflow: hidden;
      height: 100%;
      scroll-behavior: smooth;
      font-family: sans-serif;
    }

    .section {
      height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 4em;
      color: white;
    }

    .section:nth-child(1) { background: #012345; }
    .section:nth-child(2) { background: #123456; }
    .section:nth-child(3) { background: #234567; }
    .section:nth-child(4) { background: #345678; }
    .section:nth-child(5) { background: #456789; }

    .footer {
      height: 200px;
      background: pink;
      color: white;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 2em;
    }
  </style>
</head>
<body>
  <div id="container">
    <div class="section">one</div>
    <div class="section">two</div>
    <div class="section">three</div>
    <div class="section">four</div>
    <div class="section">five</div>
    <div class="footer">footer</div>
  </div>

  <script>
    const sections = document.querySelectorAll('.section');
    const footer = document.querySelector('.footer');
    const totalSections = sections.length;
    let index = 0;
    let isAnimating = false;
    let inFooter = false;

    function scrollToElement(el) {
      isAnimating = true;
      el.scrollIntoView({ behavior: 'smooth' });

      setTimeout(() => {
        isAnimating = false;
      }, 800);
    }

    function handleScroll(e) {
      if (isAnimating) return;

      if (!inFooter) {
        if (e.deltaY > 0) {
          if (index < totalSections - 1) {
            index++;
            scrollToElement(sections[index]);
          } else {
            // 마지막 섹션에서 → footer 진입
            inFooter = true;
            scrollToElement(footer);
          }
        } else {
          if (index > 0) {
            index--;
            scrollToElement(sections[index]);
          }
        }
      } else {
        // footer 상태에서 위로 스크롤하면 마지막 section 복귀
        if (e.deltaY < 0) {
          inFooter = false;
          scrollToElement(sections[totalSections - 1]);
        }
      }
    }

    // 휠 이벤트
    window.addEventListener('wheel', handleScroll, { passive: false });

    // 터치 지원 (모바일 스와이프)
    let startY = 0;
    window.addEventListener('touchstart', e => {
      startY = e.touches[0].clientY;
    });

    window.addEventListener('touchend', e => {
      let endY = e.changedTouches[0].clientY;
      let deltaY = startY - endY;
      if (Math.abs(deltaY) < 50 || isAnimating) return;

      if (!inFooter) {
        if (deltaY > 0 && index < totalSections - 1) {
          index++;
          scrollToElement(sections[index]);
        } else if (deltaY > 0) {
          inFooter = true;
          scrollToElement(footer);
        } else if (deltaY < 0 && index > 0) {
          index--;
          scrollToElement(sections[index]);
        }
      } else {
        if (deltaY < 0) {
          inFooter = false;
          scrollToElement(sections[totalSections - 1]);
        }
      }
    });

    // 초기 위치
    window.onload = () => {
      scrollToElement(sections[0]);
    };
  </script>
</body>
</html>
